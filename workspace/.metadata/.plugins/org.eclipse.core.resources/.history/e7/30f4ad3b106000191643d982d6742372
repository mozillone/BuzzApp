package ApiTestCases;

import java.io.FileNotFoundException;

import org.testng.annotations.Test;
import static com.jayway.restassured.RestAssured.*;
import static com.jayway.restassured.matcher.RestAssuredMatchers.*;
import static org.hamcrest.Matchers.*;
import com.jayway.restassured.builder.RequestSpecBuilder;
import com.jayway.restassured.response.Response;
import com.jayway.restassured.specification.RequestSpecification;
import org.json.JSONException;
import org.json.JSONObject;
import java.io.BufferedReader;
import java.io.FileReader;
import java.io.IOException;

import Base.TestBase;

public class Dummy_Test_Api extends TestBase{

	public Dummy_Test_Api() throws FileNotFoundException {
		super();
		// TODO Auto-generated constructor stub
	}
	
	@Test
	public void httpPost() throws JSONException,InterruptedException {
			
		//Initializing Rest API's URL
		String APIUrl = "http://{API URL}";
			
		//Initializing payload or API body
		String APIBody = "{API Body}"; //e.g.- "{\"key1\":\"value1\",\"key2\":\"value2\"}"
					
		// Building request using requestSpecBuilder
		RequestSpecBuilder builder = new RequestSpecBuilder();
			
		//Setting API's body
		builder.setBody(APIBody);
			
		//Setting content type as application/json or application/xml
		builder.setContentType("application/json; charset=UTF-8");
			
		RequestSpecification requestSpec = builder.build();

		//Making post request with authentication, leave blank in case there are no credentials- basic("","")
		Response response = given().authentication().preemptive().basic({username}, {password})
					.spec(requestSpec).when().post(APIUrl);
		JSONObject JSONResponseBody = new JSONObject(response.body().asString());

		//Fetching the desired value of a parameter
		String result = JSONResponseBody.getString({key});
			
		//Asserting that result of Norway is Oslo
		Assert.assertEquals(result, "{expectedValue}");

		}

}
